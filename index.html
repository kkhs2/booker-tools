<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Custom Tools for Pricing testing</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
		<script
		src="https://code.jquery.com/jquery-3.7.1.js"
		integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4="
		crossorigin="anonymous"></script>
	<script>

		const branch = {
			125: 'A1 Edinburgh (125)',
			454: 'Aberdeen (454)',
			590: 'Aberdeen Makro (590)',
			103: 'Aberystwyth (103)',
			470: 'Acton (470)',
			615: 'Advanced Supply Chain (615)',
			321: 'Aldershot (321)',
			665: 'Andover (665)',
			369: 'Ardwick (369)',
			322: 'Avonmouth (322)',
			171: 'Ayr (171)',
			361: 'Barnsley (361)'
		}

		const yesOrNo = {
			NULL: 'Null',
			Y: 'Yes',
			N: 'No'
		};
		const isDel = {
			1: 'Delete', 
			0: 'Insert or Amend'
		};
		const title = {
			Mr: 'Mr', 
			Mrs: 'Mrs', 
			Dr: 'Dr',
			Ms: 'Ms'
		};
		const facia = {
			LO: 'Londis', 
			BU: 'Budgens', 
			PR: 'Premier',
			NA: 'Non Fascia'
		};
		const canShop = {
			0: 'Collect Only',
			1: 'Orders Settled to A/C / Card Pay',
			2: 'Card Pay Only',
			3: 'Collect Settled to A/C / Card Payment'
		};
		const status = {
			C: 'Current', 
			M: 'Marked For Deletion',
			P: 'Provisional', 
			D: 'Web Dummy', 
			W: 'Web Provisional', 
			A: 'Archived'
		};
		const sop = {
			0: 'Standard',
			1: 'EDI',
			2: 'Shop / Tele /E-biz',
			3: 'EPOS',
			4: 'National Accounts',
			5: 'National Accounts - no reprice',
			6: 'CIS'
		};
		const country = {
			EN: 'England',
			SC: 'Scotland',
			WA: 'Wales',
			NI: 'Northern Ireland'
		};
		const sector = {
			1: 'C-Stores', 
			2: 'Food Retailers',
			3: 'Other Retail',
			7: 'Public House',
			8: 'Licenced Clubs',
			10: 'Restaurants'

		};

		const customerInterface = [
			{
				name: 'customerId',
				length: 9,
				type: 'input',
				required: true,
				placeholder: 'Customer ID'
			},
			{
				name: 'branchId', 
				length: 3,
				type: 'select',
				required: true,
				values: branch,
				placeholder: 'Branch ID'
			},
			{
				name: 'homeBranchId',
				length: 3,
				type: 'select',
				required: true,
				values: branch,
				placeholder: 'Home branch ID'
			},
			{
				name: 'title',
				length: 8,
				type: 'select',
				values: title,
				required: true,
				placeholder: 'Title',
			},
			{
				name: 'surname',
				length: 40,
				type: 'input',
				required: true,
				placeholder: 'Surname',
				default: 'Patrocinio'
			},
			{
				name: 'firstName',
				length:	40,
				type: 'input',
				required: true,
				placeholder: 'First name',
				default: 'Pedro'
			},
			{
				name: 'tradingName',
				length: 40,
				type: 'input',
				required: true,
				placeholder: 'Trading name',
				default: 'Booker Wholesale'
			},
			{
				name: 'street2',
				length: 40,
				type: 'input',
			},
			{
				name: 'street3',
				length: 40,
				type: 'input'	
			},
			{
				name: 'houseNumber',
				length: 10,
				type: 'input',
				required: true,
				placeholder: 'House number',
				default: '255'
			},
			{
				name: 'street',
				length: 60,
				type: 'input',
				required: true,
				placeholder: 'Street',
				default: 'Booker Street'
			},
			{
				name: 'street4',
				length: 40,
				type: 'input'
			},
			{
				name: 'street5',
				length: 40,
				type: 'input'
			},
			{
				name: 'city',
				length: 40,
				type: 'input',
				required: true,
				placeholder: 'City',
				default: 'Wellingborough'
			},
			{
				name: 'district',
				length: 40,
				type: 'input',
				required: true,
				placeholder: 'District',
				default: 'Northamptonshire'
			},
			{		
				name: 'postCode',
				length: 16,
				type: 'input',
				required: true,
				placeholder: 'Post Code',
				default: 'NN81SD'
			},
			{
				name: 'telephone',
				length: 32,
				type: 'input',
				required: true,
				placeholder: 'Telephone',
				default: '01933371000'
				
			},
			{
				name: 'mobilePhone',
				length: 32,
				type: 'input',
				required: true,
				placeholder: 'Mobile phone',
				default: '07000000000'
			},
			{
				name: 'fax',
				length: 32, 
				type: 'input'
			},
			{
				name: 'emailAddress',
				length: 100,
				type: 'input',
				placeholder: 'Email address',
				required: true
			},
			{
				name: 'prefMail',
				type: 'radio',
				values: yesOrNo,
				required: true,
				placeholder: 'Email Preference'
			},
			{
				name: 'prefTelephone',
				type: 'radio',
				values: yesOrNo,
				required: true,
				placeholder: 'Telephone Preference'
			},
			{
				name: 'prefEmail',
				type: 'radio',
				values: yesOrNo,
				required: true,
				placeholder: 'Email Preference'
			},
			{
				name: 'prefMobile',
				type: 'radio',
				values: yesOrNo,
				required: true,
				placeholder: 'Mobile Preference'
			},
			{
				name: 'licenced',
				type: 'radio',
				values: yesOrNo,
				required: true,
				placeholder: 'Licenced?'
			},
			{
				name: 'canShop',	
				type: 'select',
				values: canShop,
				required: true,
				placeholder: 'Can Shop Value'
			},
			{
				name: 'canDeliver',
				type: 'radio',
				values: yesOrNo,
				required: true,
				placeholder: 'Can Deliver?'
			},
			{
				name: 'facia',
				type: 'select',
				values: facia,
				required: true,
				placeholder: 'Fascia'
			},
			{
				name: 'classification',
				length: 2,
				type: 'input',
				required: true,
				placeholder: 'Classification'
			},
			{
				name: 'businessType',
				length: 2,
				type: 'input',
				placeholder: 'Business Type',
				required: true
			},
			{
				name: 'groupSector',
				length: 2,
				type: 'select',
				placeholder: 'Group Sector',
				values: sector,
				required: true
			},
			{
				name: 'isDel',
				type: 'radio',
				placeholder: 'Is Delete',
				required: true
			},
			{
				name: 'status',
				values: status,
				type: 'select',
				placeholder: 'Status',
				required: true
			},
			{
				name: 'onstop',
				values: yesOrNo,
				placeholder: 'Onstop',
				type: 'select',
				required: true
			},
			{
				name: 'sop',
				values: sop,
				required: true,
				type: 'select',
				placeholder: 'SOP flag'
			},
			{
				name: 'nacno', 
				length: 6,
				type: 'input',
				required: true,
				placeholder: 'National account number',
				default: '000000'
			},
			{
				name: 'vdd',
				type: 'select',
				required: true,
				placeholder: 'Dropshipment',
				values: yesOrNo
			},
			{
				name: 'prodCd',
				type: 'select',
				required: true,
				placeholder: 'Use PROD CD',
				values: yesOrNo
			},
			{
				name: 'custNo',
				length: 6,
				type: 'input',
				default: '000000'
			},
			{
				name: 'leafletScheme',
				length: 4,
				type: 'input',
			},
			{
				name: 'salesmanCode',
				length: 5,
				type: 'input',
				placeholder: 'Enter sales person code',
				default: '00000'
			},
			{
				name: 'tobaccoClub',
				type: 'select',
				values: yesOrNo,
				required: true,
				placeholder: 'Tobacco club?'
			},
			{
				name: 'countryCode',
				type: 'select',
				values: country,
				required: true,
				placeholder: 'Select country'
			}
		];

		const heading = {
			standard: 'Date,Country Code,Depot Number,Child Article Code,Saleable Unit Code,Weight Type,Number of Items in a Case,Promo Indicator,WSP Collect Price,Local Price Indicator,Standard WSP MIDAS FIELD,Standard WSP Delivered MIDAS FIELD,Start Date,End Date,Delivered Price,Online Exc Price,Click & Collect Price,Spare,Recommended Retail Price,POR,Delivered POR,Online Exclusive POR,Click & Collect POR,Spare POR,MUP WSP Collect Price,MUP Delivered Price,MUP Online Exclusive,MUP Click & Collect,MUP Spare,Promotion No,Prom Collect WSP,Prom Delivered Price,Prom Online Exclusive,Prom Click & Collect,Prom Spare,Pre Promotion Price WSP,Pre Promotion Price Delivered,Pre Promotion Price OE,Pre Promotion Price Click & Collect,Pre Promotion Price Spare,Recommended Retail Price,POR,Delivered POR,Online Exclusive POR,Click & Collect POR,Spare POR,Prom Start Date,Prom End Date',
			fascia: 'Date,Country Code,Depot Number,Child Article Code,Saleable Unit Code,Weight Type,Number of Items in a Case,Fascia Code,Promotion No,WSP Collect Price,WSP Delivered Price,WSP Online Exclusive,WSP Click & Collect Price,WSP Spare4,Pre Promotion Price WSP,Pre Promotion Price Delivered,Pre Promotion Price OE,Pre Promotion Price Click & Collect,Pre Promotion Price Spare4,Recommended Retail Price,POR,Delivered POR,Online Exclusive POR,Click & Collect POR,Spare POR,Promotion Start,Promotion End',
			club: 'Date,Country Code,Depot Number,Child Article Code,Saleable Unit Code,Weight Type,Number of Items in a Case,Club eg H13333,WSP Collect Price,WSP Delivered Price,WSP OE Price,WSP Click & Collect Price,WSP Spare4,Recommended Retail Price,POR,Delivered POR,OE POR,Click & Collect POR,Spare POR,Start Date, End Date',
			product: 'Depot Number,Hub,Saleable Unit Code,Child Article Code,Midas Split Number,Sell Price,Items in Saleable Unit,Promo,Unit ID,Recommended Retail Price,Pre Promotion Price,Percentage of Retail,Is New,Is Del,Lead Time Status,Price Start,Price End,Store Order Group,Londis Order Group'
		}

		const pattern = {
			standard: {
				regex: 
				/^(\d{8})([A-Z]{2})(\d{3})(\d{6})(\d{6})([A-Z])(\d{5,7}\.\d{2})([A-Z0]|\s)(\d{5,7}\.\d{2})([A-Z]|\s)(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})(\d{8})(\d{8})(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})(\d{2}\.\d{2})(\d{2}\.\d{2})(\d{2}\.\d{2})(\d{2}\.\d{2})(\d{2}\.\d{2})(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})([A-Z]\d{4}|\s+)(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})(\d{2}\.\d{2})(\d{2}\.\d{2})(\d{2}\.\d{2})(\d{2}\.\d{2})(\d{2}\.\d{2})(\d{8})(\d{8})$/,
				group: '$1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21,$22,$23,$24,$25,$26,$27,$28,$29,$30,$31,$32,$33,$34,$35,$36,$37,$38,$39,$40,$41,$42,$43,$44,$45,$46,$47,$48'
			},
			fascia: {
				regex: /^(\d{8})([A-Z]{2})(\d{3})(\d{6})(\d{6})([A-Z])(\d{5,7}\.\d{2})([A-Z]{2})(\w{5})(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})(\d{2}\.\d{2})(\d{2}\.\d{2})(\d{2}\.\d{2})(\d{2}\.\d{2})(\d{2}\.\d{2})(\d{8})(\d{8})$/,
				group: '$1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21,$22,$23,$24,$25,$26,$27'
			},
			club: {
				regex: /^(\d{8})([A-Z]{2})(\d{3})(\d{6})(\d{6})([A-Z])(\d{5,7}\.\d{2})(\w{6})(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})(\d{5,7}\.\d{2})(\d{2}\.\d{2})(\d{2}\.\d{2})(\d{2}\.\d{2})(\d{2}\.\d{2})(\d{2}\.\d{2})(\d{8})(\d{8})$/,
				group: '$1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21'
			}
		}
	
	const searchUrl = 'https://www.bookertest.co.uk/products/search?keywords=';
	
	
	const licensedProducts = [
			287939,
			257137,
			201393,
			208349
			
		];


		
		const unlicensedProducts = [
			175137,
			287939,
			257137,
			134907,
			201684,
			205012,
			287019,
			233096
		];
		
		const licensedOeProducts = [
			888844,
			888853
		];
		
		const unlicensedOeProducts = [
			888843,
			888844,
			888853,
			888854
		];
		
	function oeUnlicensed() {
		unlicensedOeProducts.forEach(product => 
			window.open(searchUrl + product)
		);
	}

	function oeLicensed() {
		licensedOeProducts.forEach(product => 
			window.open(searchUrl + product)
		);
	}
		

	function unlicensed() {
		unlicensedProducts.forEach(product => 
			window.open(searchUrl + product)
		);

	}
	
	function licensed() {
		licensedProducts.forEach(product =>
			window.open(searchUrl + product)
		);
	}	
	
	
	function readFile(input) {			

		let file = input.files[0];
		let reader = new FileReader();

		reader.readAsText(file);

		let csvData = [];

		/* Clear the previous "click here to download" link if exists */
		document.getElementById('downloadFile').innerHTML = '';
		
		reader.onload = function() {

			let splitLines = reader.result.split(/\r\n|\n/);


			let fileType = (file.name.includes('STDPRICE')) ? 'standard' 
			: (file.name.includes('CLBPRICE')) ? 'club'
			: (file.name.includes('FASPRICE')) ? 'fascia'
			: 'none';

			csvData.push(heading[fileType] + '\n');


			splitLines.forEach(line => {
				csvData.push(line.replace(pattern[fileType].regex, pattern[fileType].group + '\n'));
			});

			let newFile = new File(csvData, { 
				type: 'text/csv;charset=utf-8,' 
			});

	
			let objUrl = URL.createObjectURL(newFile);

			let csvFileLink = document.createElement('a')
			csvFileLink.setAttribute('href', objUrl)
			csvFileLink.setAttribute('download', file.name + 'ConvertedFile.csv')
			csvFileLink.textContent = 'Click to Download'

			document.getElementById('downloadFile').append(csvFileLink);
			
  		};
	}

	</script>
	<style>
		.booker {
      background: #2356AA;
    }
			
		.booker-jumbotron {
			background-color: #f8f8f8;
			color: #062F6E;
		}

		.required {
			color: red;
		}
	</style>

	</head>
	<body>
	<header>
		<div class="container">
			<img src="https://www.booker.co.uk/images/booker.png" class="mt-3">
		</div>
	</header>
	<main>
	<div class="jumbotron jumbotron-fluid mt-5 booker-jumbotron pt-3 pb-3">
      <div class="container">
        <h1>Tools</h1>
        <p>Some web based custom tools to try and help with the pricing project testing.</p>
      </div>
  </div>
	<div class="container pt-3 pb-3">
	
		<h3>Opening all products in one hit</h3>
		<p>Ensure allowing pop ups in your browser is enabled</p>
		<div class="mb-3">
			<button class="btn btn-primary" onclick="licensed()">Licensed</button>
			<button class="btn btn-primary" onclick="unlicensed()">Unlicensed</button>
			<button class="btn btn-primary" onclick="oeLicensed()">OE Licensed</button>
			<button class="btn btn-primary" onclick="oeUnlicensed()">OE Unlicensed</button>
		</div>
	</div>
	<div class="container pt-3 pb-3">
		<hr />
	</div>
	<div class="container pt-3 pb-3">
		
		<h3>File converter</h3>
		<p>Converts (so far) standard, fascia and club pricing files downloaded from Github into readable csv format</p>
		<div class="mb-3">
			<label for="label" class="form-label">Price File:</label>
			<input type="file" class="form-control" name="fileConvert" id="fileConvert" onchange="readFile(this)"/>
		</div>
		<div class="mb-3" id="downloadFile">
		
		</div>
	</div>
	<div class="container pt-3 pb-3">
		<hr>
	</div>
		<div class="container pt-3 pb-3">
			<h3>Customer File creator</h3>
			<p>An attempt to make this quicker / easier?
				A few points:
				<ul>
					<li>Red asterisk indicates required fields</li>
					<li>Check GitHub to find the last account number created in order to not overwrite any current accounts</li>
					<li>Accounts created should have the format of CustomerID@test.com</li>
					<li>Only required fields are showing, non-required fields are created with spaces in the background</li>
				</ul>
			</p>
			<div id="createCustomerFile"></div>
		</div>
	</main>	
	<footer>
	
	</footer>
	<script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
	<script type="text/javascript" src="https://unpkg.com/babel-standalone@6/babel.js"></script>

	<script type="text/babel">
		function Field({props}) {
			if (props.type == 'select') {
				return (
				<div className="form-floating">
					<select className="form-select" placeholder={props.placeholder} name={props.name} required>
						<option value="">Please select</option>
							{
								Object.entries(props.values).map(([k, v]) => {
									return (
										<option key={k} value={k}>{v}</option>
									)	
								})
								
							}
					</select>
					<label htmlFor="floatingSelect">{props.placeholder}</label>
				</div>
				)
			}
			if (props.type == 'input') {
				return (
					<div className="form-floating mb-3">
						<input type="text" className="form-control" placeholder={props.placeholder} name={props.name} maxLength={props.length} />
						<label forhtml="floatingInput">{props.placeholder}</label>
					</div>
				)
			}
			if (props.type == 'radio') {
				return (
					<div>
						<label>{props.placeholder}</label>
						<div className="form-check">
							<input type="radio" className="form-check-input" name={props.name} />
							<label className="form-check-label" htmlFor="yesRadio">Yes</label>
						</div>

						<div className="form-check">
							<input type="radio" className="form-check-input" name={props.name} />
							<label className="form-check-label" forhtml="noRadio">No</label>
						</div>
					</div>
				)
			}
		}

		function AddToFile() {
			return <button type="button" className="btn btn-primary">Add Line</button> 
		}

		function CreateFile() {
			
		}


		function App() {
			return ( 
				customerInterface.map(field => 
					{ field.hasOwnProperty('required') && <div><label htmlFor="label" className="required">*</label><div className="form-floating mb-3">
								<Field key={field.name} props={field} />
							</div>
							</div>
						}
							
					
				)
			)

			
			
		}

	
		const container = document.getElementById('createCustomerFile');
		const root = ReactDOM.createRoot(container);
		root.render(<App />);
	
	</script>
</body>
</html>